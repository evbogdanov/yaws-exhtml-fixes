-module(exhtml_SUITE).

-include_lib("common_test/include/ct.hrl").

-export([
  all/0,
  init_per_suite/1,
  end_per_suite/1,
  exhtml_test1/1,
  exhtml_test2/1,
  exhtml_test3/1,
  exhtml_test4/1,
  exhtml_test5/1,
  exhtml_test6/1,
  exhtml_test7/1,
  exhtml_test8/1,
  exhtml_test9/1,
  exhtml_test10/1,
  exhtml_test11/1,
  exhtml_test12/1,
  exhtml_test13/1,
  exhtml_test14/1,
  exhtml_test15/1,
  exhtml_test16/1
]).

-define(DO_TEST(N),
  {ok, {_, _, EXHTML}} = httpc:request("http://127.0.0.1:1234/t" ++ N ++ ".yaws"),
  {ok, {_, _, HTML}}   = httpc:request("http://127.0.0.1:1234/t" ++ N ++ ".html"),
  EXHTML = HTML
).

all() ->
  [
    exhtml_test1,
    exhtml_test2,
    exhtml_test3,
    exhtml_test4,
    exhtml_test5,
    exhtml_test6,
    exhtml_test7,
    exhtml_test8,
    exhtml_test9,
    exhtml_test10,
    exhtml_test11,
    exhtml_test12,
    exhtml_test13,
    exhtml_test14,
    exhtml_test15,
    exhtml_test16
  ].

init_per_suite(Config) ->
  inets:start(),
  yaws_exhtml_fixes:start(),
  Config.

end_per_suite(Config) ->
  yaws_exhtml_fixes:stop(),
  inets:stop(),
  Config.

%%------------------------------------------------------------------------------
%% doctype
%%------------------------------------------------------------------------------
exhtml_test1(_Config) ->
  ?DO_TEST("1").

%%------------------------------------------------------------------------------
%% html attr
%%------------------------------------------------------------------------------
exhtml_test2(_Config) ->
  ?DO_TEST("2").

%%------------------------------------------------------------------------------
%% more html attrs
%%------------------------------------------------------------------------------
exhtml_test3(_Config) ->
  ?DO_TEST("3").

%%------------------------------------------------------------------------------
%% self closing 'base' tag
%%------------------------------------------------------------------------------
exhtml_test4(_Config) ->
  ?DO_TEST("4").

%%------------------------------------------------------------------------------
%% more self closing tags
%%------------------------------------------------------------------------------
exhtml_test5(_Config) ->
  ?DO_TEST("5").

%%------------------------------------------------------------------------------
%% data attrs
%%------------------------------------------------------------------------------
exhtml_test6(_Config) ->
  ?DO_TEST("6").

%%------------------------------------------------------------------------------
%% tag 'select'
%%------------------------------------------------------------------------------
exhtml_test7(_Config) ->
  ?DO_TEST("7").

%%------------------------------------------------------------------------------
%% lists
%%------------------------------------------------------------------------------
exhtml_test8(_Config) ->
  ?DO_TEST("8").

%%------------------------------------------------------------------------------
%% list with children
%%------------------------------------------------------------------------------
exhtml_test9(_Config) ->
  ?DO_TEST("9").

%%------------------------------------------------------------------------------
%% list comprehension
%%------------------------------------------------------------------------------
exhtml_test10(_Config) ->
  ?DO_TEST("10").

%%------------------------------------------------------------------------------
%% classes
%%------------------------------------------------------------------------------
exhtml_test11(_Config) ->
  ?DO_TEST("11").

%%------------------------------------------------------------------------------
%% case ... of
%%------------------------------------------------------------------------------
exhtml_test12(_Config) ->
  ?DO_TEST("12").

%%------------------------------------------------------------------------------
%% nested list
%%------------------------------------------------------------------------------
exhtml_test13(_Config) ->
  ?DO_TEST("13").

%%------------------------------------------------------------------------------
%% quotes
%%------------------------------------------------------------------------------
exhtml_test14(_Config) ->
  ?DO_TEST("14").

%%------------------------------------------------------------------------------
%% unicode
%%------------------------------------------------------------------------------
exhtml_test15(_Config) ->
  ?DO_TEST("15").

%%------------------------------------------------------------------------------
%% xml
%%------------------------------------------------------------------------------
exhtml_test16(_Config) ->
  ?DO_TEST("16").
